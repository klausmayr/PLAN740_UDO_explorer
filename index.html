<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>New UDO Affordability Explorer</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Mapbox GL JS -->
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>

  <style>
    body { margin: 0; padding: 0; }
    #map { width: 100vw; height: 100vh; }
        .map-overlay {
          position: absolute;
          top: 10px;
          left: 10px;
          background: white;
          padding: 8px 12px;
          border-radius: 4px;
          font-family: sans-serif;
          font-size: 14px;
          z-index: 2;
          box-shadow: 0 1px 4px rgba(0,0,0,0.3);
        }
            .legend {
              position: absolute;
              bottom: 20px;
              left: 20px;
              background: white;
              padding: 12px;
              border-radius: 4px;
              font-family: Arial, sans-serif;
              font-size: 13px;
              line-height: 18px;
              color: #333;
              box-shadow: 0 1px 4px rgba(0,0,0,0.3);
              z-index: 2;
            }
          
            .legend h4 {
              margin: 0 0 6px;
              font-size: 14px;
            }
          
            .legend div {
              display: flex;
              align-items: center;
              margin-bottom: 4px;
            }
            .color-box {
                width: 18px;
                height: 18px;
                margin-right: 8px;
                border-radius: 3px;
                display: inline-block;
                border: 1px solid #ccc;
              }
          
            .info-icon {
                display: inline-block;
                width: 16px;
                height: 16px;
                margin-left: 6px;
                background: #ccc;
                color: #333;
                border-radius: 50%;
                text-align: center;
                line-height: 16px;
                font-size: 12px;
                cursor: pointer;
                position: relative;
              }
              
              .tooltip {
                visibility: hidden;
                width: 300px;
                opacity: 0;
                background: #333;
                color: white;
                padding: 6px 8px;
                border-radius: 4px;
                position: absolute;
                left: 20px;
                top: -4px;
                z-index: 999;
                white-space: normal;
                transition: opacity 0.2s ease-in-out;
              }
              
              .info-icon:hover .tooltip {
                visibility: visible;
                opacity: 1;
              }

              .income-swatch {
                opacity: 0.4;   /* starts dimmed since layers are invisible */
                cursor: pointer;
              }
              /* Floating info button in top right */
              .info-button {
                position: absolute;
                top: 10px;
                right: 10px;
              
                width: 28px;
                height: 28px;
              
                background: white;
                border: 2px solid rgba(0,0,0,0.25);
                border-radius: 50%;
              
                font-size: 18px;
                line-height: 24px;
                text-align: center;
                cursor: pointer;
              
                color: #333;
                font-weight: bold;
              
                display: flex;
                align-items: center;
                justify-content: center;
              
                box-shadow: 0 1px 4px rgba(0,0,0,0.25);
                z-index: 5;
              }
              
              .info-panel {
                position: absolute;
                top: 0;
                right: 0;
                width: 320px;
                height: 100%;
                background: white;
                box-shadow: -2px 0 6px rgba(0,0,0,0.25);
                transform: translateX(100%);
                transition: transform 0.3s ease-in-out;
                z-index: 5;
                font-family: Arial, sans-serif;
              }
              
              .info-panel.active {
                transform: translateX(0);
              }
              
              .info-content {
                padding: 20px;
                font-size: 14px;
                line-height: 1.4;
              }
              
              .close-btn {
                margin-top: 20px;
                padding: 6px 12px;
                background: #444;
                color: white;
                border: none;
                border-radius: 4px;
                cursor: pointer;
              }
              
  
  </style>
</head>

<body>
  <div id="map"></div>
  <div id="info-button" class="info-button">ⓘ</div>
  <div id="info-panel" class="info-panel">
    <div class="info-content">
        <h3>Instructions</h3>
        This map allows you to explore the areas of Durham County that will be affected by the proposed density bonus program.
        <br><br>
        Use the legend in the bottom right corner to toggle on/off the map of census tracks based on the Median Household Income.
        <br><br> When these layers are turned on, you can also hover over the map to see the primary residential land class types in that tract.
<br><br>
      <h3>Data Sources</h3>
      <p>
        New UDO Zoning Classes: <a href="https://services2.arcgis.com/G5vR3cOjh6g2Ed8E/arcgis/rest/services/Zoning_UDO/FeatureServer/0" target="_blank"> Durham GIS</a><br>
        Land Class Types:<a href="https://services2.arcgis.com/G5vR3cOjh6g2Ed8E/ArcGIS/rest/services/Active_Addresses/FeatureServer" target="_blank"> Durham GIS</a><br>
        Median Household Income:<a href="https://compass.durhamnc.gov/en/compass/MEDINC/blockgroup/" target="_blank"> Durham Neihborhood Compass</a><br>
                Density Bonus Program Info<a href="https://www.youtube.com/watch?v=SVzQ5tBW47U" target="_blank">New UDO Code Connect #3</a>

      </p>
  
      <button id="info-close" class="close-btn">Close</button>
    </div>
  </div>
  
  <div id="legend" class="legend">

    <h4>New UDO Draft Zoning Class<br> Proposed Density Bonuses</h4>
    <div><span class="color-box" style="background:hsl(244, 99%, 73%)"></span><label>R-D</label>
        <span class="info-icon">i
            <span class="tooltip">
                <strong>Current Comparable Zoning:</strong><br>
                RU-5, RU-5(2), RS-8, RS-10, RS-20, RR
                <br><br>
            
                <strong>Lot Size (min):</strong><br>
                Base: 5,000'<br>
                Compact & Affordable: 0'
                <br><br>
            
                <strong>Density (max):</strong><br>
                Base: 1 / lot<br>
                Compact: 1 / 1,250 SF<br>
                Affordable: 1 / 625 SF
            </span>
          </span>
    </div>

    <div><span class="color-box" style="background:hsl(17, 67%, 66%)"></span><label>RX-3, RX-5, IX, RX-8</label>
        <span class="info-icon">i
            <span class="tooltip">
                <strong>Current Comparable Zoning:</strong><br>
RS-M, RU-M, RC
                <br><br>
            
                <strong>Lot Size (min):</strong><br>
All: 0'
                <br><br>
                <strong>Unit size (max):</strong><br>
                Base & Affordable: None<br>
                Compact: 450 SF
                <br><br>
                <strong>Height (max stories):</strong><br>
                Base: 3, 5, 8<br>
                Compact: 5, 8, 13<br>
                Affordable: Unlimited
            </span>          </span>
    </div>
    <div><span class="color-box" style="background:hsl(114, 100%, 75%)"></span><label>CX-3, CX-5, CX-8, CX-20</label>
        <span class="info-icon">i
            <span class="tooltip">
                <strong>Current Comparable Zoning:</strong><br>
RS-M, RU-M, RC, DD, CD, CG, IO
                <br><br>
            
                <strong>Lot Size (min):</strong><br>
All: 0'
                <br><br>
                <strong>Unit size (max):</strong><br>
                Base & Affordable: None<br>
                Compact: 450 SF
                <br><br>
                <strong>Height (max stories):</strong><br>
                Base: 3, 5, 8<br>
                Compact: 5, 8, 13<br>
                Affordable: Unlimited
            </span>              </span>
    </div>
    <div><span class="color-box" style="background:hsla(0,0%,70%,0.70)"></span><label>Other</label></div>
  
    <h4 style="margin-top:12px;margin-bottom:0px;">Median Household Income (2023)</h4>
    <i style="margin-top:-20px; margin-bottom:20px;">click boxes to see layers then hover <br>for more info about housing types</i>

    <div class="income-swatch" data-layer="income-40">
        <span class="color-box" style="background:#e7f0fa"; margin-top:12px"></span><label>&lt; $40k</label>
    </div>
    
    <div class="income-swatch" data-layer="income-40-60">
        <span class="color-box" style="background:#c4dbf2"></span><label>$40k–$60k</label>
    </div>
    
    <div class="income-swatch" data-layer="income-60-80">
        <span class="color-box" style="background:#92c2e7"></span><label>$60k–$80k</label>
    </div>
    
    <div class="income-swatch" data-layer="income-80-100">
        <span class="color-box" style="background:#4d9ad1"></span><label>$80k–$100k</label>
    </div>
    
    <div class="income-swatch" data-layer="income-100">
        <span class="color-box" style="background:#1c6cb1"></span><label>&gt; $100k</label>
    </div>
    
  </div>
  
  
  
  <script src="script.js"></script>
</body>
</html>
